{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const createGalleryCardTemplate = imgInfo => {\n  return `\n    <li class=\"gallery-card\">\n      <a class=\"gallery-link\" href=\"${imgInfo.largeImageURL}\">\n        <img class=\"gallery-img\" src=\"${imgInfo.webformatURL}\" alt=\"${imgInfo.tags}\" />\n      </a>\n      <ul class=\"text-info\">\n        <li class=\"image-info\">\n          <h4>Likes</h4>\n          <p>${imgInfo.likes}</p>\n        </li>\n        <li class=\"image-info\">\n          <h4>Views</h4>\n          <p>${imgInfo.views}</p>\n        </li>\n        <li class=\"image-info\">\n          <h4>Comments</h4>\n          <p>${imgInfo.comments}</p>\n        </li>\n        <li class=\"image-info\">\n          <h4>Downloads</h4>\n          <p>${imgInfo.downloads}</p>\n        </li>\n      </ul>\n    </li>\n  `;\n};\n\n","import axios from 'axios';\n\nexport const fetchPhotosByQuery = (searchedEl, currentPage) => {\n  const searchParams = new URLSearchParams({\n    q: searchedEl,\n    key: '48348047-29f6f569c2c15fdf8af3c5251',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: 15,\n  });\n\n  return axios.get(`https://pixabay.com/api/?${searchParams}`);\n};","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { createGalleryCardTemplate } from './js/render-functions';\nimport { fetchPhotosByQuery } from './js/pixabay-api';\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst galleryEl = document.querySelector('.js-gallery');\nconst loader = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.js-load-btn');\n\nlet page = 1;\nlet searchedQuery = '';\nlet perPage = 15;\nlet totalHits = 0;\n\nloadBtn.classList.add('is-hidden');\n\n\nconst lightbox = new SimpleLightbox('.js-gallery a', {\n  captionDelay: 300,\n  captionsData: 'alt',\n});\n\nconst onSearchFormSubmit = async event => {\n    try {\n        event.preventDefault();\n    \n        searchedQuery = searchFormEl.elements[0].value.trim();\n\n        if (searchedQuery === '') {\n            iziToast.error({\n                message: 'Please enter your request',\n                position: 'topRight',\n            });\n            return;\n        };\n\n        page = 1;\n        loadBtn.classList.add('is-hidden');\n        loader.classList.add('show-loader');\n\n        const { data } = await fetchPhotosByQuery(searchedQuery, page);\n        totalHits = data.totalHits;\n\n        if (data.total === 0) {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight',\n            });\n\n            galleryEl.innerHTML = '';\n            searchFormEl.reset();\n\n            return;\n        }\n\n        if (data.totalHits > 1) {\n            loadBtn.classList.remove('is-hidden');\n            loadBtn.addEventListener('click', onLoadMoreBtn);\n        }\n\n        const galleryTemplate = data.hits\n            .map(el => createGalleryCardTemplate(el))\n            .join('');\n        \n        galleryEl.innerHTML = galleryTemplate;\n        lightbox.refresh();\n    \n    } catch (err) {\n        console.log(err);\n    } finally {\n        loader.classList.remove('show-loader');\n    }\n}\n  \nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\n\n\n\n\nconst onLoadMoreBtn = async () => {\n    try {\n        setTimeout(() => {\n    loader.classList.remove('show-loader');\n}, 500);\n        loader.classList.add('show-loader');\n        page++;\n\n        const { data } = await fetchPhotosByQuery(searchedQuery, page);\n\n        const galleryTemplate = data.hits\n            .map(el => createGalleryCardTemplate(el))\n            .join('');\n        galleryEl.insertAdjacentHTML('beforeend', galleryTemplate);\n        lightbox.refresh();\n        loader.classList.remove('show-loader');\n\n        const imgBox = document.querySelector('.gallery-card').getBoundingClientRect();\n        let imgHeight = imgBox.height;\n\n        window.scrollBy({\n            top: imgHeight * 2,\n            behavior: 'smooth',\n        });\n\n        if (page * perPage >= totalHits) {\n            loadBtn.classList.add('is-hidden');\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: \"topRight\",\n            });\n\n            if (!loadBtn.classList.contains('is-hidden')) {\n                loadBtn.removeEventListener('click', onLoadMoreBtn);\n            }\n        }\n    } catch (err) {\n        console.log(err);\n    }\n};\n"],"names":["createGalleryCardTemplate","imgInfo","fetchPhotosByQuery","searchedEl","currentPage","searchParams","axios","searchFormEl","galleryEl","loader","loadBtn","page","searchedQuery","perPage","totalHits","lightbox","SimpleLightbox","onSearchFormSubmit","event","iziToast","data","onLoadMoreBtn","galleryTemplate","el","err","imgHeight"],"mappings":"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"}